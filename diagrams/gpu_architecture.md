# GPU Architecture Diagram

Visual representation of modern GPU architecture for AI workloads.

## AMD CDNA Architecture (MI Series)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        AMD CDNA GPU (MI250X)                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                    Compute Die (GCD)                             │    │
│  │                                                                   │    │
│  │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐        │    │
│  │  │  CU 0  │ │  CU 1  │ │  CU 2  │ │  ...   │ │ CU 109 │        │    │
│  │  │        │ │        │ │        │ │        │ │        │        │    │
│  │  │ SIMD32 │ │ SIMD32 │ │ SIMD32 │ │ SIMD32 │ │ SIMD32 │        │    │
│  │  │  ×4    │ │  ×4    │ │  ×4    │ │  ×4    │ │  ×4    │        │    │
│  │  │        │ │        │ │        │ │        │ │        │        │    │
│  │  │LDS 64KB│ │LDS 64KB│ │LDS 64KB│ │LDS 64KB│ │LDS 64KB│        │    │
│  │  │        │ │        │ │        │ │        │ │        │        │    │
│  │  │Matrix  │ │Matrix  │ │Matrix  │ │Matrix  │ │Matrix  │        │    │
│  │  │ Core   │ │ Core   │ │ Core   │ │ Core   │ │ Core   │        │    │
│  │  └────────┘ └────────┘ └────────┘ └────────┘ └────────┘        │    │
│  │                                                                   │    │
│  │  ┌───────────────────────────────────────────────────────────┐  │    │
│  │  │                    L2 Cache (8MB)                          │  │    │
│  │  └───────────────────────────────────────────────────────────┘  │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                    │                                     │
│                           Infinity Fabric                                │
│                                    │                                     │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │                      HBM2e Memory (128GB)                        │    │
│  │   ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐      │    │
│  │   │Stack│ │Stack│ │Stack│ │Stack│ │Stack│ │Stack│ │Stack│ ...  │    │
│  │   │  0  │ │  1  │ │  2  │ │  3  │ │  4  │ │  5  │ │  6  │      │    │
│  │   └─────┘ └─────┘ └─────┘ └─────┘ └─────┘ └─────┘ └─────┘      │    │
│  │                    3.2 TB/s Bandwidth                            │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

## Compute Unit Detail

```
┌─────────────────────────────────────────────────────────────────┐
│                      Compute Unit (CU)                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                 Wavefront Scheduler                       │   │
│  │            (manages up to 40 wavefronts)                  │   │
│  └──────────────────────────────────────────────────────────┘   │
│                           │                                      │
│     ┌─────────────────────┼─────────────────────┐               │
│     │                     │                     │               │
│  ┌──▼───┐  ┌──────┐  ┌──▼───┐  ┌──────┐       │               │
│  │SIMD32│  │SIMD32│  │SIMD32│  │SIMD32│       │               │
│  │ Unit │  │ Unit │  │ Unit │  │ Unit │       │               │
│  │      │  │      │  │      │  │      │       │               │
│  │16 ALU│  │16 ALU│  │16 ALU│  │16 ALU│       │               │
│  └──┬───┘  └──┬───┘  └──┬───┘  └──┬───┘       │               │
│     │         │         │         │            │               │
│     └─────────┴────┬────┴─────────┘            │               │
│                    │                            │               │
│  ┌─────────────────▼────────────────────────┐  │               │
│  │         Vector Register File             │  │               │
│  │          (256KB per CU)                  │  │               │
│  └──────────────────────────────────────────┘  │               │
│                                                  │               │
│  ┌──────────────────────────────────────────┐  │               │
│  │        Local Data Share (LDS)            │  │               │
│  │              64KB                         │  │               │
│  │    32 banks × 512 × 32-bit words         │  │               │
│  └──────────────────────────────────────────┘  │               │
│                                                  │               │
│  ┌─────────────┐  ┌─────────────────────────┐  │               │
│  │   Scalar    │  │      Matrix Core        │  │               │
│  │    Unit     │  │   (CDNA2: MFMA ops)    │  │               │
│  │  (SGPRs)    │  │                         │  │               │
│  └─────────────┘  └─────────────────────────┘  │               │
│                                                  │               │
│  ┌──────────────────────────────────────────┐  │               │
│  │            L1 Cache (16KB)               │  │               │
│  └──────────────────────────────────────────┘  │               │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

## Execution Model

```
┌─────────────────────────────────────────────────────────────────┐
│                     Kernel Execution Flow                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   User Code        Runtime           Hardware                    │
│   ─────────        ───────           ────────                    │
│                                                                  │
│   kernel<<<       hipLaunchKernel    Command                     │
│   grid,block>>>        │             Processor                   │
│        │               │                 │                       │
│        ▼               ▼                 ▼                       │
│   ┌─────────┐    ┌─────────┐       ┌─────────┐                  │
│   │  Grid   │    │ Command │       │  Work   │                  │
│   │ Config  │───►│  Queue  │──────►│  Distr. │                  │
│   └─────────┘    └─────────┘       └────┬────┘                  │
│                                          │                       │
│                    ┌────────────────────┬┴────────────────────┐  │
│                    │                    │                     │  │
│              ┌─────▼─────┐       ┌─────▼─────┐        ┌──────▼┐ │
│              │   CU 0    │       │   CU 1    │   ...  │ CU N  │ │
│              │           │       │           │        │       │ │
│              │ Block 0,4 │       │ Block 1,5 │        │Block..│ │
│              │  8,12..   │       │  9,13..   │        │       │ │
│              └───────────┘       └───────────┘        └───────┘ │
│                                                                  │
│   Block ────────────► Wavefronts (64 threads each)              │
│                            │                                     │
│                       SIMT Execution                             │
│                     (same instruction,                           │
│                      different data)                             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

## Key Specifications Comparison

```
┌────────────────┬────────────┬────────────┬────────────┬────────────┐
│  Specification │  MI250X    │  MI300X    │  H100 SXM  │  RTX 4090  │
├────────────────┼────────────┼────────────┼────────────┼────────────┤
│  Architecture  │  CDNA2     │  CDNA3     │  Hopper    │  Ada       │
│  Compute Units │  220       │  304       │  132 SM    │  128 SM    │
│  FP32 TFLOPS   │  47.9      │  163       │  66.9      │  82.6      │
│  FP16 TFLOPS   │  383       │  1307      │  989       │  165       │
│  Memory        │  128GB HBM │  192GB HBM │  80GB HBM  │  24GB GDDR │
│  Bandwidth     │  3.2 TB/s  │  5.3 TB/s  │  3.35 TB/s │  1 TB/s    │
│  TDP           │  500W      │  750W      │  700W      │  450W      │
└────────────────┴────────────┴────────────┴────────────┴────────────┘
```
