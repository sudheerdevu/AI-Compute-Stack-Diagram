# AI Compute Stack - Full Architecture

This document provides a comprehensive view of the AI compute stack.

## Full Stack Diagram (ASCII)

```
┌────────────────────────────────────────────────────────────────────────────────┐
│                              APPLICATION LAYER                                  │
├────────────────────────────────────────────────────────────────────────────────┤
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│   │  ChatGPT    │  │  Stable     │  │  Speech     │  │  Autonomous         │  │
│   │  Claude     │  │  Diffusion  │  │  Recognition│  │  Vehicles           │  │
│   │  LLMs       │  │  DALL-E     │  │  TTS        │  │  Robotics           │  │
│   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌────────────────────────────────────────────────────────────────────────────────┐
│                              FRAMEWORK LAYER                                    │
├────────────────────────────────────────────────────────────────────────────────┤
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│   │  PyTorch    │  │  TensorFlow │  │  JAX        │  │  Transformers       │  │
│   │             │  │             │  │             │  │  (HuggingFace)      │  │
│   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────────────┘  │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│   │  ONNX       │  │  vLLM       │  │  TensorRT   │  │  DeepSpeed          │  │
│   │  Runtime    │  │             │  │  LLM        │  │  FSDP               │  │
│   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌────────────────────────────────────────────────────────────────────────────────┐
│                            COMPILER/RUNTIME LAYER                               │
├────────────────────────────────────────────────────────────────────────────────┤
│   ┌─────────────────────────────────────────────────────────────────────────┐  │
│   │                           GRAPH COMPILER                                 │  │
│   │   ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────────────┐   │  │
│   │   │  XLA      │  │  TorchDy- │  │  TVM      │  │  MLIR/Triton      │   │  │
│   │   │           │  │  namo     │  │           │  │                   │   │  │
│   │   └───────────┘  └───────────┘  └───────────┘  └───────────────────┘   │  │
│   └─────────────────────────────────────────────────────────────────────────┘  │
│   ┌─────────────────────────────────────────────────────────────────────────┐  │
│   │                           KERNEL LIBRARIES                               │  │
│   │   ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────────────┐   │  │
│   │   │  rocBLAS  │  │  MIOpen   │  │  RCCL     │  │  cuBLAS/cuDNN     │   │  │
│   │   │  hipBLAS  │  │  MIGraphX │  │           │  │  NCCL             │   │  │
│   │   └───────────┘  └───────────┘  └───────────┘  └───────────────────┘   │  │
│   └─────────────────────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌────────────────────────────────────────────────────────────────────────────────┐
│                            GPU PROGRAMMING LAYER                                │
├────────────────────────────────────────────────────────────────────────────────┤
│   ┌─────────────────────────────────────────────────────────────────────────┐  │
│   │   ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────────────┐   │  │
│   │   │    HIP    │  │   CUDA    │  │   SYCL    │  │    OpenCL         │   │  │
│   │   │           │  │           │  │           │  │                   │   │  │
│   │   └───────────┘  └───────────┘  └───────────┘  └───────────────────┘   │  │
│   └─────────────────────────────────────────────────────────────────────────┘  │
│   ┌─────────────────────────────────────────────────────────────────────────┐  │
│   │   ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────────────┐   │  │
│   │   │   HSA     │  │  CUDA     │  │   Level   │  │    Vulkan         │   │  │
│   │   │  Runtime  │  │  Driver   │  │   Zero    │  │   Compute         │   │  │
│   │   └───────────┘  └───────────┘  └───────────┘  └───────────────────┘   │  │
│   └─────────────────────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌────────────────────────────────────────────────────────────────────────────────┐
│                              DRIVER LAYER                                       │
├────────────────────────────────────────────────────────────────────────────────┤
│   ┌─────────────────────────────────────────────────────────────────────────┐  │
│   │   ┌────────────────────┐           ┌────────────────────┐              │  │
│   │   │   AMDGPU Driver    │           │   NVIDIA Driver    │              │  │
│   │   │   (amdgpu.ko)      │           │   (nvidia.ko)      │              │  │
│   │   └────────────────────┘           └────────────────────┘              │  │
│   │                                                                         │  │
│   │   ┌────────────────────┐           ┌────────────────────┐              │  │
│   │   │   KFD (GPU        │           │   DRM Subsystem    │              │  │
│   │   │   Scheduler)       │           │   (GPU Management) │              │  │
│   │   └────────────────────┘           └────────────────────┘              │  │
│   └─────────────────────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────────────────────┘
                                         │
                                         ▼
┌────────────────────────────────────────────────────────────────────────────────┐
│                              HARDWARE LAYER                                     │
├────────────────────────────────────────────────────────────────────────────────┤
│   ┌──────────────────────────────┐    ┌──────────────────────────────────┐    │
│   │        AMD GPUS              │    │        NVIDIA GPUS               │    │
│   │   ┌─────────────────────┐   │    │   ┌─────────────────────┐        │    │
│   │   │  MI300X  (CDNA3)    │   │    │   │  H100    (Hopper)   │        │    │
│   │   │  MI250X  (CDNA2)    │   │    │   │  A100    (Ampere)   │        │    │
│   │   │  MI100   (CDNA1)    │   │    │   │  V100    (Volta)    │        │    │
│   │   │  RX 7900 (RDNA3)    │   │    │   │  RTX 4090 (Ada)     │        │    │
│   │   └─────────────────────┘   │    │   └─────────────────────┘        │    │
│   └──────────────────────────────┘    └──────────────────────────────────┘    │
│   ┌──────────────────────────────┐    ┌──────────────────────────────────┐    │
│   │        INTERCONNECT          │    │        MEMORY                    │    │
│   │   ┌─────────────────────┐   │    │   ┌─────────────────────┐        │    │
│   │   │  Infinity Fabric    │   │    │   │  HBM3/HBM2e         │        │    │
│   │   │  NVLink/NVSwitch    │   │    │   │  GDDR6X             │        │    │
│   │   │  PCIe Gen5          │   │    │   │  1.5 - 3.5 TB/s     │        │    │
│   │   └─────────────────────┘   │    │   └─────────────────────┘        │    │
│   └──────────────────────────────┘    └──────────────────────────────────┘    │
└────────────────────────────────────────────────────────────────────────────────┘
```

## Layer Descriptions

### Application Layer
End-user applications and models consuming AI infrastructure.

### Framework Layer  
High-level APIs for model development, training, and deployment.

### Compiler/Runtime Layer
Optimizes and executes computation graphs on hardware.

### GPU Programming Layer
Low-level APIs for direct GPU programming.

### Driver Layer
Manages GPU resources and schedules work.

### Hardware Layer
Physical compute devices executing workloads.
